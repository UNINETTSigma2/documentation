

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Slurm Parameter and Settings &mdash; Sigma2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/nris.css?v=69e7a171" />
      <link rel="stylesheet" type="text/css" href="../../_static/universal-navbar.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/statuspal.css" />

  
    <link rel="shortcut icon" href="../../_static/nris.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://siteimproveanalytics.com/js/siteanalyze_6036825.js"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../_static/statuspal_widget.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">
<!-- Send url to parent when displayed as iframe -->
<script>
    const valid_orign_url = "https://www.sigma2.no"
    window.addEventListener('message', function(event) {
        if (event.data === 'getDocumentationIframeUrl' && event.origin.startsWith(valid_orign_url)) {
            // path only (/path/example.html)
            const path = window.location.pathname
            // query string (including the initial ? symbol)
            const search = window.location.search
            // Returns the hash (including the initial # symbol)
            const hash = window.location.hash
            const newUrl = path + search + hash;
            event.source.postMessage(newUrl, event.origin)
        }
    })

</script>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Sigma2/NRIS documentation
              <img src="../../_static/NRIS Logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Policies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code-of-conduct.html">Code of Conduct</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/support_line.html">Getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/extended_support.html">Extended support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/how_to_write_good_support_requests.html">Writing good support requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/qa-sessions.html">Open Question &amp; Answer Sessions for All Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/lost_forgotten_password.html">Lost, expiring or changing passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/two_factor_authentication.html">One-time-pad (OTP) / Two-factor authentication</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.sigma2.no/project-leader-handbook">Project Leader Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../training/events.html">Training events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/notes_qa.html">Questions, Answers and Feedbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/past_training.html">An overview over training events in the past</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/videos.html">Training Video Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/short_instructions.html">Short Instructions Video Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/material.html">Training materials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/opslog.html">Status and maintenance of systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/applying_account.html">How do I get an account?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/applying_resources.html">Applying for computing and storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/file_transfer.html">File transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/editing_files.html">Editing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/guides/vs_code/connect_to_server.html">Connecting to a system with Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ssh.html">SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ssh.html#common-ssh-errors">Common SSH errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ood.html">Open OnDemand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/R.html">First R calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Files, storage and backup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/nird_lmd.html">NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/clusters.html">Storage areas on HPC clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/quota.html">Storage quota</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/backup.html">Backup on Betzy, Fram, Saga, and NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/sharing_files.html">Data handling and storage policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/performance.html">Optimizing storage performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HPC usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/migration2metacenter.html">Migration to an NRIS HPC machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computing/responsible-use.html">Using shared resources responsibly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Running jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internet-login-compute-nodes.html">Login nodes:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internet-login-compute-nodes.html#compute-nodes">Compute nodes:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computing/tuning-applications.html">Tuning applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/guides_llm.html">Running LLM Models in a Cluster Environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compute resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/hardware_overview.html">Overview over our machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/betzy.html">Betzy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/fram.html">Fram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/olivia.html">Olivia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/saga.html">Saga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/lumi.html">LUMI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../software/modulescheme.html">Software module scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/installed_software.html">Installed software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/userinstallsw.html">Installing software as user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/appguides.html">Application guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/licenses.html">Licence and access policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/eessi.html">EESSI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../nird_archive/sandbox-user-guide.html">NIRD Research Data Archive Sandbox (NIRD RDA sandbox)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_archive/user-guide.html">NIRD Research Data Archive (NIRD RDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_toolkit/overview.html">NIRD Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_service_platform/overview_nird_service_platform.html">NIRD Service Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/easydmp-user-documentation.html">EasyDMP User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/course_resources.html">CRaaS - Course Resources as a Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code development and tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/overview.html">Code development and tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sigma2/NRIS documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Slurm Parameter and Settings</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="slurm-parameter-and-settings">
<h1>Slurm Parameter and Settings<a class="headerlink" href="#slurm-parameter-and-settings" title="Link to this heading"></a></h1>
<p>Slurm supports a multitude of different parameters. This enables you to
effectively tailor your script to your need but also
means that is easy to get lost and waste your time and quota.</p>
<p>The following parameters can be used as command line parameters with
<code class="docutils literal notranslate"><span class="pre">sbatch</span></code> and <code class="docutils literal notranslate"><span class="pre">srun</span></code> or in jobscripts. To use it in a jobscript, start
a newline with <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> followed by the parameter. Replace &lt;….&gt;
with the value you want, e.g. <code class="docutils literal notranslate"><span class="pre">--job-name=test-job</span></code>.</p>
<section id="slurm-parameter">
<h2>Slurm Parameter<a class="headerlink" href="#slurm-parameter" title="Link to this heading"></a></h2>
<section id="basic-settings">
<h3>Basic settings:<a class="headerlink" href="#basic-settings" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--job-name=&lt;name&gt;</span></code></p></td>
<td><p>Job name to be displayed by for example <code class="docutils literal notranslate"><span class="pre">squeue</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--output=&lt;path&gt;</span></code></p></td>
<td><p>Path to the file where the job (error) output is written to</p></td>
</tr>
</tbody>
</table>
</section>
<section id="requesting-resources">
<h3>Requesting Resources<a class="headerlink" href="#requesting-resources" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--time=&lt;d-hh:mm:ss&gt;</span></code></p></td>
<td><p>Time limit for job. Job will be killed by Slurm after time has run out. Format days-hours:minutes:seconds.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--nodes=&lt;num_nodes&gt;</span></code></p></td>
<td><p>Number of nodes. Multiple nodes are only useful for jobs with distributed-memory (e.g. MPI).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--mem=&lt;MB&gt;</span></code></p></td>
<td><p>Minimum memory (RAM) per node. Number followed by unit prefix, e.g. 16G.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--mem-per-cpu=&lt;MB&gt;</span></code></p></td>
<td><p>Minimum memory (RAM) per requested physical CPU core Number followed by unit prefix, e.g. 4G.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks-per-node=&lt;num_procs&gt;</span></code></p></td>
<td><p>Number of (MPI) processes per node. More than one useful only for MPI jobs. Maximum number depends nodes (number of cores).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--cpus-per-task=&lt;num_threads&gt;</span></code></p></td>
<td><p>CPU cores per task. For MPI use one. For parallelized applications benchmark this is the number of threads.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="accounting">
<h3>Accounting<a class="headerlink" href="#accounting" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--account=&lt;name&gt;</span></code></p></td>
<td><p>Project (not user) account the job should be charged to.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--partition=&lt;name&gt;</span></code></p></td>
<td><p>Partition/queue in which to run the job.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--qos=&lt;devel/short&gt;</span></code></p></td>
<td><p>The <em>devel</em> or <em>short</em> QOS (quality of servive) can be used to submit short jobs for testing and debugging.</p></td>
</tr>
</tbody>
</table>
<p>See also <a class="reference internal" href="../projects_accounting.html#projects-accounting"><span class="std std-ref">Projects and accounting</span></a> for more information.</p>
<p>Slurm differs slightly from the previous Torque system with respect to
definitions of various parameters, and what was known as queues in
Torque may be covered by either <code class="docutils literal notranslate"><span class="pre">--partition=...</span></code> or <code class="docutils literal notranslate"><span class="pre">--qos=...</span></code>.</p>
<p>Check our cluster specific sites for an overview of the partitions and
QOS of that system:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../job_types/betzy_job_types.html#job-types-betzy"><span class="std std-ref">Job Types on Betzy</span></a></p></li>
<li><p><a class="reference internal" href="../job_types/fram_job_types.html#job-types-fram"><span class="std std-ref">Job Types on Fram</span></a></p></li>
<li><p><a class="reference internal" href="../job_types/saga_job_types.html#job-types-saga"><span class="std std-ref">Job Types on Saga</span></a></p></li>
</ul>
</section>
<section id="advanced-job-control">
<h3>Advanced Job Control<a class="headerlink" href="#advanced-job-control" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--array=&lt;indexes&gt;</span></code></p></td>
<td><p>Submit a collection of similar jobs, e.g. <code class="docutils literal notranslate"><span class="pre">--array=1-10</span></code>. (sbatch command only). <a class="reference internal" href="array_jobs.html"><span class="std std-doc">More info</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--dependency=&lt;state:jobid&gt;</span></code></p></td>
<td><p>Wait with the start of the job until specified dependencies have been satified. E.g. –dependency=afterok:123456,</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks-per-core=2</span></code></p></td>
<td><p>Enables hyperthreading. Only useful in special circumstances.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="differences-between-cpus-and-tasks">
<h2>Differences between CPUs and tasks<a class="headerlink" href="#differences-between-cpus-and-tasks" title="Link to this heading"></a></h2>
<p>As a new users writing your first Slurm job script the difference
between <code class="docutils literal notranslate"><span class="pre">--ntasks</span></code> and <code class="docutils literal notranslate"><span class="pre">--cpus-per-taks</span></code> is typically quite confusing.
Assuming you want to run your program on a single node with 16 cores
which Slurm parameters should you specify?</p>
<p>The answer is it depends whether the your application supports MPI. MPI
(message passing protocol) is a communication interface used for
developing parallel computing programs on distributed memory systems.
This is necessary for applications running on multiple computers (nodes)
to be able to share (intermediate) results.</p>
<p>To decide which set of parameters you should use, check if your
application utilizes MPI and therefore would benefit from running on
multiple nodes simultaneously. On the other hand you have an non-MPI
enables application or made a mistake in your setup, it doesn’t make
sense to request more than one node.</p>
</section>
<section id="settings-for-openmp-and-mpi-jobs">
<h2>Settings for OpenMP and MPI jobs<a class="headerlink" href="#settings-for-openmp-and-mpi-jobs" title="Link to this heading"></a></h2>
<section id="single-node-jobs">
<h3>Single node jobs<a class="headerlink" href="#single-node-jobs" title="Link to this heading"></a></h3>
<p>For applications that are not optimized for HPC (high performance
computing) systems like simple python or R scripts and a lot of software
which is optimized for desktop PCs.</p>
<section id="simple-applications-and-scripts">
<h4>Simple applications and scripts<a class="headerlink" href="#simple-applications-and-scripts" title="Link to this heading"></a></h4>
<p>Many simple tools and scripts are not parallized at all and therefore
won’t profit from more than one CPU core.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--nodes=1</span></code></p></td>
<td><p>Start a unparallized job on only one node.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks-per-node=1</span></code></p></td>
<td><p>For OpenMP, only one task is necessary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--cpus-per-task=1</span></code></p></td>
<td><p>Just one CPU core will be used.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--mem=&lt;MB&gt;</span></code></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>If you are unsure if your application can benefit from more cores try a
higher number and observe the load of your job. If it stays at
approximately one there is no need to ask for more than one.</p>
</section>
<section id="openmp-applications">
<h4>OpenMP applications<a class="headerlink" href="#openmp-applications" title="Link to this heading"></a></h4>
<p>OpenMP (Open Multi-Processing) is a multiprocessing library is often
used for programs on shared memory systems. Shared memory describes
systems which share the memory between all processing units (CPU cores),
so that each process can access all data on that system.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--nodes=1</span></code></p></td>
<td><p>Start a parallel job for a shared memory system on only one node.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks-per-node=1</span></code></p></td>
<td><p>For OpenMP, only one task is necessary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--cpus-per-task=&lt;num_threads&gt;</span></code></p></td>
<td><p>Number of threads (CPU cores) to use.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--mem=&lt;MB&gt;</span></code></p></td>
<td><p>Minimum memory (RAM) per node. Number followed by unit prefix, e.g. 16G.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="multiple-node-jobs-mpi">
<h3>Multiple node jobs (MPI)<a class="headerlink" href="#multiple-node-jobs-mpi" title="Link to this heading"></a></h3>
<p>For MPI applications.</p>
<p>Depending on the frequency and bandwidth demand of your setup, you can choose two
distribution schemes:</p>
<ul class="simple">
<li><p>Let Slurm determine where to put your parallel MPI tasks as it see fit.</p></li>
<li><p>Force Slurm to group all MPI tasks on whole nodes.</p></li>
</ul>
<p>The latter approach of using whole nodes guarantees a low latency and high bandwidth, but it
usually results in a longer queuing time compared to cluster wide job.
With the former approach, the Slurm manager distribute your task to maximize utilization.
This usually results in shorter queuing times but slower inter-task connection speeds and latency.
What is suitable for you depends entirely on your ability to wait and the requirements of the application
that are set for execution.</p>
<p>However, if it is suitable for you, we would recommend the former approach as it will make the best use of the resources
and give the most predictable execution times. If your job requires more than the default
available memory per core (for example 32 GB/node gives 2 GB/core for 16 core nodes
and 1.6GB/core for 20 core nodes) you should adjust this need with the
following command: <code class="docutils literal notranslate"><span class="pre">#SBATCH</span> <span class="pre">--mem-per-cpu=4GB</span></code>. When doing this, the
batch system will automatically allocate 8 cores or less per node.</p>
<section id="task-placement-on-whole-nodes">
<h4>Task placement on whole nodes<a class="headerlink" href="#task-placement-on-whole-nodes" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--nodes=&lt;num_nodes&gt;</span></code></p></td>
<td><p>Start a parallel job for a distributed memory system on several nodes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks-per-node=&lt;num_procs&gt;</span></code></p></td>
<td><p>Number of (MPI) processes per node. Maximum number depends on nodes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--cpus-per-task=1</span></code></p></td>
<td><p>Use one CPU core per task.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--exclusive</span></code></p></td>
<td><p>Job will not share nodes with other running jobs. You don’t need to specify memory as you will get all available on the node.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="general-task-placement">
<h4>General task placement<a class="headerlink" href="#general-task-placement" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Function</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--ntasks=&lt;num_procs&gt;</span></code></p></td>
<td><p>Number of (MPI) processes in total. Equals to the number of cores/</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--mem-per-cpu=&lt;MB&gt;</span></code></p></td>
<td><p>Memory (RAM) per requested CPU core. Number followed by unit prefix, e.g. 2G.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="scalability">
<h3>Scalability<a class="headerlink" href="#scalability" title="Link to this heading"></a></h3>
<p>You should run a few tests to see what is the best fit between
minimizing runtime and maximizing your allocated cpu-quota. That is you
should not ask for more cpus for a job than you really can utilize
efficiently. Try to run your job on 1, 2, 4, 8, 16, etc., cores to see
when the runtime for your job starts tailing off. When you start to see
less than 30% improvement in runtime when doubling the cpu-counts you
should probably not go any further. Recommendations to a few of the most
used applications can be found in sw_guides.</p>
</section>
<section id="a-few-notes-about-memory">
<h3>A few notes about memory<a class="headerlink" href="#a-few-notes-about-memory" title="Link to this heading"></a></h3>
<p>It is possible to specify the used memory using either <code class="docutils literal notranslate"><span class="pre">mem</span></code> or <code class="docutils literal notranslate"><span class="pre">mem-per-cpu</span></code>. The former can give some surprises in
particular if not used together with <code class="docutils literal notranslate"><span class="pre">ntasks-per-node</span></code>, or another flag to fix the number of cores available to the job.
For instance if you set <code class="docutils literal notranslate"><span class="pre">mem=300G</span></code> and <code class="docutils literal notranslate"><span class="pre">ntasks=10</span></code> you could either get 10 tasks on a node with 300 GB or one task on
10 nodes, each demanding 300 GB. You are always accounted for the effective CPU time. In this case, say that each CPU has
30 GB available (<code class="docutils literal notranslate"><span class="pre">memory_per_cpu</span></code>). Even though the job only run on one CPU per node, you are accounted for 300/<code class="docutils literal notranslate"><span class="pre">memory_per_cpu</span></code> GB, meaning 10 CPUs.
In total you are thus accounted for the usage of 100 CPUs.</p>
</section>
<section id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading"></a></h3>
<section id="srun-warning-can-t-honor-ntasks-per-node-set-to-x-which-doesn-t-match-the-requested-tasks-y-with-the-number-of-requested-nodes-y-ignoring-ntasks-per-node">
<h4>“srun: Warning: can’t honor –ntasks-per-node set to <em>X</em> which doesn’t match the requested tasks <em>Y</em> with the number of requested nodes <em>Y</em>. Ignoring –ntasks-per-node.”<a class="headerlink" href="#srun-warning-can-t-honor-ntasks-per-node-set-to-x-which-doesn-t-match-the-requested-tasks-y-with-the-number-of-requested-nodes-y-ignoring-ntasks-per-node" title="Link to this heading"></a></h4>
<p>This warning appears when using the <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> command with Intel MPI and
specifying <code class="docutils literal notranslate"><span class="pre">--ntasks-per-node</span></code> for jobs in the <code class="docutils literal notranslate"><span class="pre">normal</span></code> partition on Fram.  As
far as we have seen, the job does <em>not</em> ignore the <code class="docutils literal notranslate"><span class="pre">--ntasks-per-node</span></code>, and
will run the specified number of processes per node.  You can test it with,
e.g., <code class="docutils literal notranslate"><span class="pre">mpirun</span> <span class="pre">hostname</span></code>.  Please let us know if you have an example where
<code class="docutils literal notranslate"><span class="pre">--ntasks-per-node</span></code> is <em>not</em> honored!</p>
<p>So, if you get this when using <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> with Intel MPI, our recommendation is
currently that the warning can be ignored.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Sigma2/NRIS. Text shared under CC-BY 4.0 license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>