

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Job Scripts on Olivia &mdash; Sigma2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/nris.css?v=69e7a171" />
      <link rel="stylesheet" type="text/css" href="../../_static/universal-navbar.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/statuspal.css" />

  
    <link rel="shortcut icon" href="../../_static/nris.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://siteimproveanalytics.com/js/siteanalyze_6036825.js"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../_static/statuspal_widget.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">
<!-- Send url to parent when displayed as iframe -->
<script>
    const valid_orign_url = "https://www.sigma2.no"
    window.addEventListener('message', function(event) {
        if (event.data === 'getDocumentationIframeUrl' && event.origin.startsWith(valid_orign_url)) {
            // path only (/path/example.html)
            const path = window.location.pathname
            // query string (including the initial ? symbol)
            const search = window.location.search
            // Returns the hash (including the initial # symbol)
            const hash = window.location.hash
            const newUrl = path + search + hash;
            event.source.postMessage(newUrl, event.origin)
        }
    })

</script>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Sigma2/NRIS documentation
              <img src="../../_static/NRIS Logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Policies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code-of-conduct.html">Code of Conduct</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/support_line.html">Getting help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/extended_support.html">Extended support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/faq.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/how_to_write_good_support_requests.html">Writing good support requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/qa-sessions.html">Open Question &amp; Answer Sessions for All Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/lost_forgotten_password.html">Lost, expiring or changing passwords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/two_factor_authentication.html">One-time-pad (OTP) / Two-factor authentication</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.sigma2.no/project-leader-handbook">Project Leader Support</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Training</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../training/events.html">Training events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/notes_qa.html">Questions, Answers and Feedbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/past_training.html">An overview over training events in the past</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/videos.html">Training Video Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/short_instructions.html">Short Instructions Video Archives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training/material.html">Training materials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/opslog.html">Status and maintenance of systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/applying_account.html">How do I get an account?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/applying_resources.html">Applying for computing and storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/file_transfer.html">File transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/editing_files.html">Editing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/guides/vs_code/connect_to_server.html">Connecting to a system with Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ssh.html">SSH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ssh.html#common-ssh-errors">Common SSH errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/ood.html">Open OnDemand</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/R.html">First R calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Files, storage and backup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/nird_lmd.html">NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/clusters.html">Storage areas on HPC clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/quota.html">Storage quota</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/backup.html">Backup on Betzy, Fram, Saga, and NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/sharing_files.html">Data handling and storage policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../files_storage/performance.html">Optimizing storage performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">HPC usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/migration2metacenter.html">Migration to an NRIS HPC machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computing/responsible-use.html">Using shared resources responsibly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Running jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internet-login-compute-nodes.html">Login nodes:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internet-login-compute-nodes.html#compute-nodes">Compute nodes:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../computing/tuning-applications.html">Tuning applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/guides_llm.html">Running LLM Models in a Cluster Environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compute resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/hardware_overview.html">Overview over our machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/betzy.html">Betzy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/fram.html">Fram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/olivia.html">Olivia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/saga.html">Saga</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc_machines/lumi.html">LUMI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../software/modulescheme.html">Software module scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/installed_software.html">Installed software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/userinstallsw.html">Installing software as user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/appguides.html">Application guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/licenses.html">Licence and access policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/eessi.html">EESSI</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../nird_archive/sandbox-user-guide.html">NIRD Research Data Archive Sandbox (NIRD RDA sandbox)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_archive/user-guide.html">NIRD Research Data Archive (NIRD RDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_toolkit/overview.html">NIRD Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../nird_service_platform/overview_nird_service_platform.html">NIRD Service Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../services/easydmp-user-documentation.html">EasyDMP User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_help/course_resources.html">CRaaS - Course Resources as a Service</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Code development and tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_development/overview.html">Code development and tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sigma2/NRIS documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Job Scripts on Olivia</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="job-scripts-on-olivia">
<span id="id1"></span><h1>Job Scripts on Olivia<a class="headerlink" href="#job-scripts-on-olivia" title="Link to this heading"></a></h1>
<p>This page documents how to specify the queue system parameters for the
different job types on Olivia. See <a class="reference internal" href="../job_types/olivia_job_types.html#job-types-olivia"><span class="std std-ref">Job Types on Olivia</span></a>
for information about the different job types on Olivia.  See also
<a class="reference internal" href="stage_in_stage_out.html#stage-in-stage-out"><span class="std std-ref">Staging In / Out Files from / to NIRD using Slurm</span></a> for how to automatically copy files from and
to NIRD.</p>
<section id="normal">
<span id="job-scripts-olivia-normal"></span><h2>Normal<a class="headerlink" href="#normal" title="Link to this heading"></a></h2>
<p>The basic type of job on Olivia is the <em>normal</em> job.</p>
<p><em>Normal</em> jobs must specify account (<code class="docutils literal notranslate"><span class="pre">--account</span></code>), walltime limit
(<code class="docutils literal notranslate"><span class="pre">--time</span></code>) and how much memory is needed.  Usually, they will also
specify the number of tasks (i.e., processes) to run (<code class="docutils literal notranslate"><span class="pre">--ntasks</span></code> - the
default is 1), and they can also specify how many cpus each task
should get (<code class="docutils literal notranslate"><span class="pre">--cpus-per-task</span></code> - the default is 1).</p>
<p>The jobs can also specify how man tasks should be run per node
(<code class="docutils literal notranslate"><span class="pre">--ntasks-per-node</span></code>), or how many nodes the tasks should be
distributed over (<code class="docutils literal notranslate"><span class="pre">--nodes</span></code>).  Without any of these two
specifications, the tasks will be distributed on any available
resources.</p>
<p>Memory usage is specified with <code class="docutils literal notranslate"><span class="pre">--mem-per-cpu</span></code>, in <em>MiB</em>
(<code class="docutils literal notranslate"><span class="pre">--mem-per-cpu=3600M</span></code>) or <em>GiB</em> (<code class="docutils literal notranslate"><span class="pre">--mem-per-cpu=4G</span></code>).</p>
<p>If a job tries to use more (resident) memory on a compute node than it
requested, it will be killed.  Note that it is the <em>total</em> memory
usage on each node that counts, not the usage per task or cpu.  So,
for instance, if your job has two single-cpu tasks on a node and asks
for 2 GiB RAM per cpu, the total limit on that node will be 4 GiB.
The queue system does not care if one of the tasks uses more than 2
GiB, as long as the total usage on the node is not more than 4 GiB.</p>
<p>A typical job specification for a normal job would be</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#SBATCH --account=MyProject
#SBATCH --job-name=MyJob
#SBATCH --time=1-0:0:0
#SBATCH --mem-per-cpu=2G
#SBATCH --ntasks=128
</pre></div>
</div>
<p>This will start 128 tasks (processes), each one getting one cpu and 2
GiB RAM.  The tasks can be distributed on any number of nodes (up to
128, of course).</p>
<p>To run multithreaded applications, use <code class="docutils literal notranslate"><span class="pre">--cpus-per-task</span></code> to allocate
the right number of cpus to each task.  <code class="docutils literal notranslate"><span class="pre">--cpus-per-task</span></code> sets the
environment variable <code class="docutils literal notranslate"><span class="pre">$OMP_NUM_THREADS</span></code> so that OpenMP programs by
default will use the right number of threads.  (It is possible to
override this number by setting <code class="docutils literal notranslate"><span class="pre">$OMP_NUM_THREADS</span></code> in the job script.)
For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#SBATCH --account=MyProject
#SBATCH --job-name=MyJob
#SBATCH --time=1-0:0:0
#SBATCH --mem-per-cpu=2G
#SBATCH --ntasks=8 --cpus-per-task=64 --ntasks-per-node=4
</pre></div>
</div>
<p>This job will get 2 nodes, and run 4 processes on each of them, each
process getting 64 cpus.  All in all, that will be two whole nodes on
Olivia.</p>
<p>All jobs on Olivia are allocated the requested cpus and memory
exclusively, but share nodes with other jobs.  Also note that they are
bound to the cpu cores they are allocated.  However, the tasks and
threads are free to use all cores the job has access to on the node.</p>
<p>Note that the more restrictive one is in specifying how tasks are
placed on nodes, the longer the job might have to wait in the job
queue: In this example, for instance, there might be eight nodes with
64 idle cpus, but not two whole idle nodes.  Without the
<code class="docutils literal notranslate"><span class="pre">--ntasks-per-node</span></code> specification, the job could have started now, but
with the specification, it will have to wait.</p>
<p>The <a class="reference internal" href="olivia/olivia_sample_mpi_job.html"><span class="std std-doc">Olivia Sample MPI Job</span></a> page has an example
of a <em>normal</em> MPI job.</p>
</section>
<section id="accel">
<span id="job-scripts-olivia-accel"></span><h2>Accel<a class="headerlink" href="#accel" title="Link to this heading"></a></h2>
<p><em>Accel</em> jobs are specified just like <em>normal</em> jobs except that they
also have to specify <code class="docutils literal notranslate"><span class="pre">--partition=accel</span></code>.  In addition, they must also
specify how many GPUs to use, and how they should be distributed
across nodes and tasks.  The simplest way to do that is, with
<code class="docutils literal notranslate"><span class="pre">--gpus=N</span></code> or <code class="docutils literal notranslate"><span class="pre">--gpus-per-node=N</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of GPUs to
use.</p>
<p>For a job simple job running one process and using one GPU, the
following example is enough:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#SBATCH --account=MyProject --job-name=MyJob
#SBATCH --partition=accel --gpus=1
#SBATCH --time=1-0:0:0
#SBATCH --mem-per-cpu=8G
</pre></div>
</div>
<p>Here is an example that asks for 2 tasks and 2 GPUs on one node:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#SBATCH --account=MyProject --job-name=MyJob
#SBATCH --partition=accel
#SBATCH --time=1-0:0:0
#SBATCH --ntasks-per-node=2 --gpus-per-node=2 --nodes=1
#SBATCH --mem-per-cpu=8G
</pre></div>
</div>
<p>There are other GPU related specifications that can be used, and that
parallel some of the cpu related specifications.  The most useful are
probably:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--gpus-per-node</span></code> How many GPUs the job should have on each node.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gpus-per-task</span></code> How many GPUs the job should have per task.
Requires the use of <code class="docutils literal notranslate"><span class="pre">--ntasks</span></code> or <code class="docutils literal notranslate"><span class="pre">--gpus</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--gpus-per-socket</span></code> How many GPUs the job should have on each
socket.  Requires the use of <code class="docutils literal notranslate"><span class="pre">--sockets-per-node</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--mem-per-gpu</span></code> How much RAM the job should have for each GPU.
Can be used <em>instead of</em> <code class="docutils literal notranslate"><span class="pre">--mem-per-cpu</span></code>, (but cannot be used
<em>together with</em> it).</p></li>
</ul>
<p>See <a class="reference external" href="https://slurm.schedmd.com/sbatch.html">sbatch</a> or <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">sbatch</span></code>
for the details, and other GPU related specifications.</p>
<p>(The old way of specifying GPUs: <code class="docutils literal notranslate"><span class="pre">--gres=gpu:N</span></code> is still supported,
but is less flexible than the above specification.)</p>
<p>The <a class="reference internal" href="olivia/olivia_sample_gpu_job.html"><span class="std std-doc">Olivia Sample GPU Job</span></a> page has an example
of a GPU job.</p>
</section>
<section id="devel">
<span id="job-scripts-olivia-devel"></span><h2>Devel<a class="headerlink" href="#devel" title="Link to this heading"></a></h2>
<p><em>Devel</em> jobs must specify <code class="docutils literal notranslate"><span class="pre">--qos=devel</span></code>.  A <em>devel</em> job is like a <em>normal</em>
job, except that it has restrictions on job length and size.</p>
<p>For instance:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#SBATCH --account=MyProject
#SBATCH --job-name=MyJob
#SBATCH --qos=devel
#SBATCH --time=00:30:00
#SBATCH --ntasks=16
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Sigma2/NRIS. Text shared under CC-BY 4.0 license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>